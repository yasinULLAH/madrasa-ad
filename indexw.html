<!DOCTYPE html>

<html dir="rtl" lang="ur">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Islamic Madrasa Admission Poster Creator</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Nastaliq+Urdu:wght@400;700&amp;family=Amiri:wght@400;700&amp;display=swap" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
<style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Noto Nastaliq Urdu', 'Amiri', serif;
      background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    .header {
      background: linear-gradient(135deg, #ffffff, #f1f5f9);
      padding: 25px;
      border-radius: 20px;
      box-shadow: 0 15px 50px rgba(0, 0, 0, 0.3);
      margin-bottom: 30px;
      text-align: center;
      border: 3px solid #f59e0b;
    }

    .header h1 {
      color: #0c4a6e;
      font-size: 2.8em;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
    }

    .header p {
      color: #475569;
      font-size: 1.3em;
      font-weight: 600;
    }

    .controls {
      display: flex;
      gap: 15px;
      margin-bottom: 30px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .btn {
      padding: 14px 28px;
      border: none;
      border-radius: 10px;
      font-size: 17px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
      font-family: 'Noto Nastaliq Urdu', sans-serif;
    }

    .btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
    }

    .btn-primary {
      background: linear-gradient(135deg, #0c4a6e, #075985);
      color: white;
    }

    .btn-success {
      background: linear-gradient(135deg, #047857, #065f46);
      color: white;
    }

    .btn-warning {
      background: linear-gradient(135deg, #f59e0b, #d97706);
      color: white;
    }

    .btn-danger {
      background: linear-gradient(135deg, #dc2626, #b91c1c);
      color: white;
    }

    .btn-info {
      background: linear-gradient(135deg, #0284c7, #0369a1);
      color: white;
    }

    .poster-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
      gap: 30px;
      margin-bottom: 30px;
    }

    .poster-card {
      background: white;
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
      transition: transform 0.3s ease;
      border: 4px solid #f59e0b;
    }

    .poster-card:hover {
      transform: translateY(-8px) scale(1.02);
    }

    .poster-preview {
      width: 100%;
      height: auto;
      cursor: pointer;
    }

    .poster-actions {
      padding: 18px;
      display: flex;
      gap: 12px;
      justify-content: space-around;
      background: linear-gradient(135deg, #f8fafc, #e2e8f0);
    }

    .poster-actions button {
      flex: 1;
      padding: 10px;
      font-size: 15px;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      z-index: 1000;
      overflow-y: auto;
      padding: 20px;
    }

    .modal.active {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-content {
      background: white;
      border-radius: 20px;
      padding: 35px;
      max-width: 1000px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      position: relative;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
    }

    .modal-close {
      position: absolute;
      top: 15px;
      right: 15px;
      font-size: 35px;
      cursor: pointer;
      color: #dc2626;
      background: none;
      border: none;
      font-weight: bold;
    }

    .modal-close:hover {
      color: #991b1b;
    }

    .form-group {
      margin-bottom: 22px;
    }

    .form-group label {
      display: block;
      margin-bottom: 10px;
      font-weight: 700;
      color: #1e293b;
      font-size: 17px;
    }

    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 14px;
      border: 3px solid #cbd5e1;
      border-radius: 10px;
      font-size: 16px;
      font-family: 'Noto Nastaliq Urdu', sans-serif;
      transition: border 0.3s ease;
    }

    .form-group input:focus,
    .form-group textarea:focus,
    .form-group select:focus {
      outline: none;
      border-color: #f59e0b;
    }

    .form-group textarea {
      min-height: 120px;
      resize: vertical;
    }

    .form-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 18px;
    }

    .poster-template {
      width: 700px;
      height: 990px;
      background: linear-gradient(135deg, #e0f2fe 0%, #bae6fd 50%, #e0f2fe 100%);
      position: relative;
      overflow: hidden;
      margin: 0 auto;
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.3);
    }

    .decorative-minaret {
      position: absolute;
      width: 80px;
      height: 200px;
      background: linear-gradient(135deg, #92400e, #78350f);
      top: 40px;
    }

    .decorative-minaret.left {
      left: 30px;
    }

    .decorative-minaret.right {
      right: 30px;
    }

    .minaret-dome {
      width: 40px;
      height: 40px;
      background: #14b8a6;
      border-radius: 50% 50% 0 0;
      position: absolute;
      top: -30px;
      left: 50%;
      transform: translateX(-50%);
    }

    .minaret-spire {
      width: 8px;
      height: 35px;
      background: #115e59;
      position: absolute;
      top: -60px;
      left: 50%;
      transform: translateX(-50%);
    }

    .minaret-crescent {
      width: 20px;
      height: 20px;
      border: 3px solid #fbbf24;
      border-radius: 50%;
      position: absolute;
      top: -75px;
      left: 50%;
      transform: translateX(-50%);
      clip-path: polygon(50% 0, 100% 0, 100% 100%, 50% 100%);
    }

    .decorative-lantern {
      position: absolute;
      width: 50px;
      height: 80px;
      top: 120px;
    }

    .decorative-lantern.left {
      left: 130px;
    }

    .decorative-lantern.right {
      right: 130px;
    }

    .lantern-body {
      width: 100%;
      height: 60px;
      background: linear-gradient(135deg, #0891b2, #06b6d4);
      border-radius: 10px;
      position: relative;
      box-shadow: 0 0 20px rgba(8, 145, 178, 0.6);
    }

    .lantern-top {
      width: 80%;
      height: 15px;
      background: #fbbf24;
      position: absolute;
      top: -12px;
      left: 10%;
      border-radius: 5px 5px 0 0;
    }

    .lantern-bottom {
      width: 60%;
      height: 10px;
      background: #fbbf24;
      position: absolute;
      bottom: -8px;
      left: 20%;
      clip-path: polygon(0 0, 100% 0, 85% 100%, 15% 100%);
    }

    .decorative-crescent {
      position: absolute;
      width: 100px;
      height: 100px;
      top: 50px;
    }

    .decorative-crescent.left {
      left: 20px;
    }

    .decorative-crescent.right {
      right: 20px;
    }

    .crescent-shape {
      width: 80px;
      height: 80px;
      background: #fbbf24;
      border-radius: 50%;
      position: relative;
      box-shadow: 0 0 30px rgba(251, 191, 36, 0.5);
    }

    .crescent-inner {
      width: 60px;
      height: 60px;
      background: #e0f2fe;
      border-radius: 50%;
      position: absolute;
      top: 10px;
      right: 5px;
    }

    .diamond-shape {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, #0c4a6e, #0369a1);
      transform: rotate(45deg);
      position: absolute;
      top: 20px;
      left: 20px;
      box-shadow: 0 0 20px rgba(12, 74, 110, 0.5);
    }

    .poster-main-header {
      background: linear-gradient(135deg, #b91c1c 0%, #dc2626 50%, #b91c1c 100%);
      margin: 250px 100px 30px 100px;
      padding: 25px 40px;
      border-radius: 25px;
      text-align: center;
      position: relative;
      box-shadow: 0 10px 30px rgba(185, 28, 28, 0.5);
      border: 5px solid #fbbf24;
    }

    .poster-main-header::before,
    .poster-main-header::after {
      content: '';
      position: absolute;
      width: 150px;
      height: 100%;
      background: linear-gradient(135deg, #fbbf24, #f59e0b);
      top: 0;
    }

    .poster-main-header::before {
      left: -50px;
      clip-path: polygon(0 0, 100% 0, 100% 100%, 30% 100%);
    }

    .poster-main-header::after {
      right: -50px;
      clip-path: polygon(0 0, 70% 0, 100% 100%, 0 100%);
    }

    .main-title {
      font-size: 42px;
      color: white;
      font-weight: bold;
      margin-bottom: 10px;
      text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.3);
      position: relative;
      z-index: 1;
    }

    .subtitle {
      font-size: 36px;
      color: white;
      font-weight: bold;
      position: relative;
      z-index: 1;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }

    .dates-oval {
      background: linear-gradient(135deg, #0c4a6e, #075985);
      margin: 0 150px;
      padding: 20px;
      border-radius: 50%;
      text-align: center;
      position: relative;
      box-shadow: 0 8px 25px rgba(12, 74, 110, 0.4);
      border: 4px solid #fbbf24;
    }

    .date-item {
      color: white;
      font-size: 22px;
      font-weight: bold;
      margin: 5px 0;
    }

    .date-number {
      display: inline-block;
      background: white;
      color: #0c4a6e;
      padding: 5px 15px;
      border-radius: 50%;
      margin-left: 10px;
      font-weight: bold;
    }

    .three-sections {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      margin: 30px 25px;
    }

    .section-box {
      text-align: center;
    }

    .section-header {
      padding: 15px;
      border-radius: 15px;
      font-size: 24px;
      font-weight: bold;
      color: white;
      margin-bottom: 15px;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
    }

    .section-header.orange {
      background: linear-gradient(135deg, #f59e0b, #d97706);
    }

    .section-header.green {
      background: linear-gradient(135deg, #064e3b, #065f46);
    }

    .section-content {
      padding: 20px 15px;
      border-radius: 0 0 50% 50%;
      min-height: 180px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 10px;
      border: 3px dotted white;
      box-shadow: inset 0 0 20px rgba(255, 255, 255, 0.3);
    }

    .section-content.blue {
      background: linear-gradient(135deg, #1e40af, #1e3a8a);
    }

    .section-content.pink {
      background: linear-gradient(135deg, #db2777, #be185d);
    }

    .content-item {
      color: white;
      font-size: 16px;
      text-align: center;
      line-height: 1.6;
    }

    .timing-bar {
      background: linear-gradient(135deg, #14b8a6, #0d9488);
      margin: 20px 40px;
      padding: 18px;
      border-radius: 15px;
      text-align: center;
      color: white;
      font-size: 22px;
      font-weight: bold;
      box-shadow: 0 8px 25px rgba(20, 184, 166, 0.4);
    }

    .location-bar {
      background: linear-gradient(135deg, #0c4a6e, #075985);
      margin: 15px 40px;
      padding: 18px;
      border-radius: 15px;
      text-align: center;
      color: white;
      font-size: 18px;
      font-weight: bold;
      box-shadow: 0 8px 25px rgba(12, 74, 110, 0.4);
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 15px;
    }

    .ornament {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, #dc2626, #b91c1c);
      clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
      box-shadow: 0 0 15px rgba(220, 38, 38, 0.6);
    }

    .bottom-section {
      display: grid;
      grid-template-columns: 1fr 2fr 1fr;
      gap: 15px;
      margin: 20px 25px;
    }

    .side-box {
      background: linear-gradient(135deg, #f59e0b, #d97706);
      padding: 20px 15px;
      border-radius: 15px;
      color: white;
      text-align: center;
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 10px;
      box-shadow: 0 8px 25px rgba(245, 158, 11, 0.4);
      border: 3px solid #78350f;
    }

    .side-box-title {
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 10px;
      text-decoration: underline;
    }

    .side-box-content {
      font-size: 15px;
      line-height: 1.7;
    }

    .center-box {
      background: linear-gradient(135deg, #064e3b, #065f46);
      padding: 25px 20px;
      border-radius: 20px;
      color: white;
      text-align: center;
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 12px;
      box-shadow: 0 8px 25px rgba(6, 78, 59, 0.5);
      border: 4px solid #fbbf24;
    }

    .center-box-title {
      font-size: 26px;
      font-weight: bold;
      line-height: 1.5;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }

    .center-box-content {
      font-size: 14px;
      line-height: 1.8;
    }

    .footer-banner {
      background: linear-gradient(135deg, #78350f, #92400e);
      margin: 20px 0 0 0;
      padding: 20px;
      text-align: center;
      color: white;
      display: flex;
      justify-content: space-around;
      align-items: center;
    }

    .footer-item {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 16px;
      font-weight: bold;
    }

    .phone-number {
      font-size: 18px;
      font-weight: bold;
    }

    .footer-text {
      flex: 1;
      text-align: center;
      font-size: 20px;
      font-weight: bold;
    }

    .diamond-icon {
      width: 30px;
      height: 30px;
      background: #fbbf24;
      transform: rotate(45deg);
      display: inline-block;
      margin: 0 10px;
    }

    .loading {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 40px;
      border-radius: 20px;
      box-shadow: 0 15px 50px rgba(0, 0, 0, 0.4);
      display: none;
      z-index: 2000;
      border: 4px solid #f59e0b;
    }

    .loading.active {
      display: block;
    }

    .spinner {
      width: 60px;
      height: 60px;
      border: 6px solid #e2e8f0;
      border-top-color: #0c4a6e;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    .preview-container {
      max-width: 100%;
      overflow: auto;
      background: #f1f5f9;
      padding: 25px;
      border-radius: 15px;
    }

    @media (max-width: 768px) {
      .poster-grid {
        grid-template-columns: 1fr;
      }

      .poster-template {
        transform: scale(0.45);
        transform-origin: top center;
      }

      .modal-content {
        padding: 20px;
      }

      .controls {
        flex-direction: column;
      }

      .btn {
        width: 100%;
      }

      .form-row {
        grid-template-columns: 1fr;
      }
    }
  </style>
<link href="manifest.json" rel="manifest"/><link href="favicon.ico" rel="icon" type="image/x-icon"/></head>
<body>
<div class="container">
<div class="header">
<h1>ğŸ•Œ Ù…Ø¯Ø±Ø³Û Ø§Ø¹Ù„Ø§Ù† Ù¾ÙˆØ³Ù¹Ø± ØªØ®Ù„ÛŒÙ‚ Ú©Ø§Ø±</h1>
<p>Islamic Madrasa Admission Poster Creator &amp; Management System</p>
</div>
<div class="controls">
<button class="btn btn-primary" onclick="openCreateModal()">â• Ù†ÛŒØ§ Ø§Ø¹Ù„Ø§Ù† Ø¨Ù†Ø§Ø¦ÛŒÚº</button>
<button class="btn btn-success" onclick="exportAllData()">ğŸ’¾ ÚˆÛŒÙ¹Ø§ Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº</button>
<button class="btn btn-warning" onclick="document.getElementById('importFile').click()">ğŸ“‚ ÚˆÛŒÙ¹Ø§ Ø¯Ø±Ø¢Ù…Ø¯
        Ú©Ø±ÛŒÚº</button>
<button class="btn btn-danger" onclick="deleteAllPosters()">ğŸ—‘ï¸ Ø³Ø¨ Ø­Ø°Ù Ú©Ø±ÛŒÚº</button>
</div>
<input accept=".json" id="importFile" onchange="importData(event)" style="display:none" type="file"/>
<div class="poster-grid" id="posterGrid"></div>
</div>
<div class="modal" id="editorModal">
<div class="modal-content">
<button class="modal-close" onclick="closeModal()">Ã—</button>
<h2 style="margin-bottom: 30px; color: #0c4a6e; text-align: center; font-size: 2em;">ğŸ“ Ù¾ÙˆØ³Ù¹Ø± Ø§ÛŒÚˆÛŒÙ¹Ø±</h2>
<form id="posterForm" onsubmit="savePoster(event)">
<input id="posterId" type="hidden"/>
<div class="form-group">
<label>Ù…Ø±Ú©Ø²ÛŒ Ø¹Ù†ÙˆØ§Ù† (Main Title)</label>
<input id="mainTitle" required="" type="text"/>
</div>
<div class="form-row">
<div class="form-group">
<label>ØªØ§Ø±ÛŒØ® Ø§Ø³Ù„Ø§Ù…ÛŒ (Islamic Date)</label>
<input id="islamicDate" required="" type="text"/>
</div>
<div class="form-group">
<label>ØªØ§Ø±ÛŒØ® Ø¹ÛŒØ³ÙˆÛŒ (Gregorian Date)</label>
<input id="gregorianDate" required="" type="text"/>
</div>
</div>
<div class="form-row">
<div class="form-group">
<label>Ø´Ø±ÙˆØ¹ ØªØ§Ø±ÛŒØ® (Start Date)</label>
<input id="startDate" required="" type="text"/>
</div>
<div class="form-group">
<label>Ø¢Ø®Ø±ÛŒ ØªØ§Ø±ÛŒØ® (End Date)</label>
<input id="endDate" required="" type="text"/>
</div>
</div>
<div class="form-group">
<label>Ø³ÛŒÚ©Ø´Ù† 1 Ø¹Ù†ÙˆØ§Ù† (Section 1 Title)</label>
<input id="section1Title" required="" type="text"/>
</div>
<div class="form-group">
<label>Ø³ÛŒÚ©Ø´Ù† 1 Ù…ÙˆØ§Ø¯ (Section 1 Content - Ø¹Ù„Ø§Ù…Øª Ø³Û’ Ø§Ù„Ú¯ Ú©Ø±ÛŒÚº)</label>
<textarea id="section1Content" required=""></textarea>
</div>
<div class="form-group">
<label>Ø³ÛŒÚ©Ø´Ù† 2 Ø¹Ù†ÙˆØ§Ù† (Section 2 Title)</label>
<input id="section2Title" required="" type="text"/>
</div>
<div class="form-group">
<label>Ø³ÛŒÚ©Ø´Ù† 2 Ù…ÙˆØ§Ø¯ (Section 2 Content - Ø¹Ù„Ø§Ù…Øª Ø³Û’ Ø§Ù„Ú¯ Ú©Ø±ÛŒÚº)</label>
<textarea id="section2Content" required=""></textarea>
</div>
<div class="form-group">
<label>Ø³ÛŒÚ©Ø´Ù† 3 Ø¹Ù†ÙˆØ§Ù† (Section 3 Title)</label>
<input id="section3Title" required="" type="text"/>
</div>
<div class="form-group">
<label>Ø³ÛŒÚ©Ø´Ù† 3 Ù…ÙˆØ§Ø¯ (Section 3 Content - Ø¹Ù„Ø§Ù…Øª Ø³Û’ Ø§Ù„Ú¯ Ú©Ø±ÛŒÚº)</label>
<textarea id="section3Content" required=""></textarea>
</div>
<div class="form-group">
<label>Ø§ÙˆÙ‚Ø§Øª (Timing)</label>
<input id="timing" required="" type="text"/>
</div>
<div class="form-group">
<label>Ù…Ù‚Ø§Ù… Ù…Ø¹Ù„ÙˆÙ…Ø§Øª (Location Info)</label>
<textarea id="locationInfo" required="" rows="2"></textarea>
</div>
<div class="form-group">
<label>Ø¨Ø§Ø¦ÛŒÚº Ø¨Ø§Ú©Ø³ Ø¹Ù†ÙˆØ§Ù† (Left Box Title)</label>
<input id="leftBoxTitle" required="" type="text"/>
</div>
<div class="form-group">
<label>Ø¨Ø§Ø¦ÛŒÚº Ø¨Ø§Ú©Ø³ Ù…ÙˆØ§Ø¯ (Left Box Content - Ø¹Ù„Ø§Ù…Øª Ø³Û’ Ø§Ù„Ú¯ Ú©Ø±ÛŒÚº)</label>
<textarea id="leftBoxContent" required=""></textarea>
</div>
<div class="form-group">
<label>Ù…Ø±Ú©Ø²ÛŒ Ø¨Ø§Ú©Ø³ Ø¹Ù†ÙˆØ§Ù† (Center Box Title)</label>
<input id="centerBoxTitle" required="" type="text"/>
</div>
<div class="form-group">
<label>Ù…Ø±Ú©Ø²ÛŒ Ø¨Ø§Ú©Ø³ Ù…ÙˆØ§Ø¯ (Center Box Content)</label>
<textarea id="centerBoxContent" required=""></textarea>
</div>
<div class="form-group">
<label>Ø¯Ø§Ø¦ÛŒÚº Ø¨Ø§Ú©Ø³ Ø¹Ù†ÙˆØ§Ù† (Right Box Title)</label>
<input id="rightBoxTitle" required="" type="text"/>
</div>
<div class="form-group">
<label>Ø¯Ø§Ø¦ÛŒÚº Ø¨Ø§Ú©Ø³ Ù…ÙˆØ§Ø¯ (Right Box Content - Ø¹Ù„Ø§Ù…Øª Ø³Û’ Ø§Ù„Ú¯ Ú©Ø±ÛŒÚº)</label>
<textarea id="rightBoxContent" required=""></textarea>
</div>
<div class="form-group">
<label>Ø±Ø§Ø¨Ø·Û Ù†Ù…Ø¨Ø±Ø² (Contact Numbers - Ú©ÙˆÙ…Ø§ Ø³Û’ Ø§Ù„Ú¯ Ú©Ø±ÛŒÚº)</label>
<input id="contactNumbers" required="" type="text"/>
</div>
<div class="form-group">
<label>Ù…Ø¯Ø±Ø³Û Ú©Ø§ Ù†Ø§Ù… (Madrasa Name)</label>
<input id="madrasaName" required="" type="text"/>
</div>
<div class="form-group">
<label>Ù…Ø¯Ø±Ø³Û Ú©Ø§ Ù¾ØªÛ (Madrasa Address)</label>
<textarea id="madrasaAddress" required="" rows="2"></textarea>
</div>
<div style="display: flex; gap: 18px; margin-top: 30px;">
<button class="btn btn-success" style="flex: 1;" type="submit">ğŸ’¾ Ù…Ø­ÙÙˆØ¸ Ú©Ø±ÛŒÚº</button>
<button class="btn btn-danger" onclick="closeModal()" style="flex: 1;" type="button">âŒ Ù…Ù†Ø³ÙˆØ® Ú©Ø±ÛŒÚº</button>
</div>
</form>
</div>
</div>
<div class="modal" id="previewModal">
<div class="modal-content" style="max-width: 750px;">
<button class="modal-close" onclick="closePreviewModal()">Ã—</button>
<h2 style="margin-bottom: 25px; text-align: center; color: #0c4a6e; font-size: 2em;">ğŸ‘ï¸ Ù¾ÙˆØ³Ù¹Ø± Ù¾ÛŒØ´ Ù†Ø¸Ø§Ø±Û</h2>
<div class="preview-container" id="previewContainer"></div>
<div style="display: flex; gap: 18px; margin-top: 25px;">
<button class="btn btn-primary" onclick="exportToPNG()" style="flex: 1;">ğŸ–¼ï¸ PNG ÚˆØ§Ø¤Ù† Ù„ÙˆÚˆ</button>
<button class="btn btn-info" onclick="exportToPDF()" style="flex: 1;">ğŸ“„ PDF ÚˆØ§Ø¤Ù† Ù„ÙˆÚˆ</button>
<button class="btn btn-danger" onclick="closePreviewModal()" style="flex: 1;">âŒ Ø¨Ù†Ø¯ Ú©Ø±ÛŒÚº</button>
</div>
</div>
</div>
<div class="loading" id="loadingOverlay">
<div class="spinner"></div>
<p style="text-align: center; font-weight: 700; color: #0c4a6e; font-size: 18px;">â³ Ø¨Ø±Ø§Û Ú©Ø±Ù… Ø§Ù†ØªØ¸Ø§Ø± Ú©Ø±ÛŒÚº...</p>
</div>
<script>
    let db;
    let currentPosterId = null;
    let currentPosterData = null;

    const initDB = () => {
      return new Promise((resolve, reject) => {
        const request = indexedDB.open('MadrasaPosterDB', 1);
        request.onerror = () => reject(request.error);
        request.onsuccess = () => {
          db = request.result;
          resolve(db);
        };
        request.onupgradeneeded = (event) => {
          const database = event.target.result;
          if (!database.objectStoreNames.contains('posters')) {
            const objectStore = database.createObjectStore('posters', { keyPath: 'id', autoIncrement: true });
            objectStore.createIndex('mainTitle', 'mainTitle', { unique: false });
            objectStore.createIndex('createdAt', 'createdAt', { unique: false });
          }
        };
      });
    };

    const seedInitialData = async () => {
      const transaction = db.transaction(['posters'], 'readonly');
      const objectStore = transaction.objectStore('posters');
      const countRequest = objectStore.count();
      countRequest.onsuccess = async () => {
        if (countRequest.result === 0) {
          const seedData = [
            {
              mainTitle: 'Ø§Ø¹Ù„Ø§Ù† Ø¯Ø§Ø®Ù„Û',
              islamicDate: '1445Ú¾',
              gregorianDate: '2024Ø¡',
              startDate: '10 Ø´ÙˆØ§Ù„ Ø§Ù„Ù…Ú©Ø±Ù… 1445',
              endDate: '20 Ø§Ù¾Ø±ÛŒÙ„ 2024',
              section1Title: 'Ø¹ØµØ±ÛŒ Ø¹Ù„ÙˆÙ…',
              section1Content: 'Ø§Ù†Ú¯Ø±ÛŒØ²ÛŒ Ø²Ø¨Ø§Ù† Ú©ÛŒ ØªØ¹Ù„ÛŒÙ…|Ø¯ÛŒÙ†ÛŒ ØªØ¹Ù„ÛŒÙ… Ú©Û’ Ø³Ø§ØªÚ¾|Ù…Ø§ÛØ±ÛŒÙ† Ú©Û’ Ø³Ø§ØªÚ¾ Ø­ÙØ¸ Ú©Ø±ÛŒÚº|Ù…ÛŒÙ¹Ø±Ú© Ú©Û’ Ø³Ø§ØªÚ¾ Ù…Ø¹ÛŒØ§Ø±ÛŒ Ø¹ØµØ±ÛŒ ØªØ¹Ù„ÛŒÙ…',
              section2Title: 'ØªØ¬ÙˆÛŒØ¯Ø§Ù„Ù‚Ø±Ø¢Ù†',
              section2Content: 'Ø­Ø§ÙØ¸ Ø¨Ù†Ù†Û’ Ú©Û’ Ù„ÛŒÛ’ Ø¨ÛØªØ±ÛŒÙ† Ù…Ø§Ø­ÙˆÙ„|Ù…Ø¤Ø«Ù‚ Ø§Ù„Ø¹Ù„Ù…Ø§Ø¡ Ú©Û’ Ø²ÛŒØ± Ù†Ø¸Ø±Ø§Ù†ÛŒØ³|Ù‚Ø±Ø§Ù† Ú©Ø±ÛŒÙ… Ú©ÛŒ ØµØ­ÛŒØ­ ØªÙ„Ø§ÙˆØª|Ø­ÙØ¸ Ø³Û’ Ù…Ø­Ø¨ÙˆØ¨ Ø±Ø³ÙˆÙ„ Ú©ÛŒ Ø¢ÙˆØ§Ø² Ø³Ù†Ù†Ø§|Ù†ÙØ§Ø¦Ø¬',
              section3Title: 'Ø¯Ø±Ø³ Ù†Ø¸Ø§Ù…ÛŒ',
              section3Content: 'Ø§ÙˆÙ„ÛŒÙ° Ø³Û’ Ø¹Ø§Ù„Ù…ÛŒÛ ØªÚ© ØªØ¹Ù„ÛŒÙ…|Ù…ÛØ§Ø±Øª ÙÙ† Ø­Ø§ØµÙ„ Ú©Ø±ÛŒÚº|Ø¯ÛŒÙ†ÛŒ ØªØ±Ø¨ÛŒØª Ú©Û’ Ø³Ø§ØªÚ¾ ØµØ§Ø­Ø¨ Ø¹Ø§Ù„Ù…|Ø§Ø³Ù„Ø§Ù…ÛŒ ØªØ¹Ù„ÛŒÙ… Ø³ÛŒÚ©Ú¾Ù†Û’ Ú©Ø§ Ø³Ù†ÛØ±ÛŒ|Ù…ÙˆÙ‚Ø¹',
              timing: 'Ø§ÙˆÙ‚Ø§Øª Ø¯Ø§Ø®Ù„Û: ØµØ¨Ø­ 8:00 ØªØ§ 12:30',
              locationInfo: 'Ø´ÛŒÚˆÙˆÙ„ Ø­ÙØ¸ Ø³Û’ Ù…ØªØ¹Ù„Ù‚ 10 Ø´ÙˆØ§Ù„ Ø¨Û Ù…Ø·Ø§Ø¨Ù‚ 20 Ø§Ù¾Ø±ÛŒÙ„ Ø§ÙˆØ± Ø¯Ø±Ø³ Ù†Ø¸Ø§Ù…ÛŒ Ú©Û’ Ø·Ù„Ø¨Ø§Ø¡ Ú©Û’ Ù„ÛŒÛ’ 13 Ø´ÙˆØ§Ù„ 23 Ø§Ù¾Ø±ÛŒÙ„ Ø³Û’ Ù…Ø­ÙÙˆØ¸ Ø±ÛÛŒÚº',
              leftBoxTitle: 'Ù…Ø²ÛŒØ¯ Ú©Û’ Ù„ÛŒÛ’',
              leftBoxContent: 'Ù…Ø§ÛØ§Ù†Û Ù…Ø¹Ø§Ø´Ø±Û Ø³ÙˆÙ„Û ØµØ¯|Ø§Ù¾Ø±ÛŒÚˆ Ø§Ø­Ø§Ø·Û Ú¯Ø§Ø±ÚˆÙ†Ø² Ú©Û’ Ù‚Ø±ÛŒØ¨|ØµØ¨Ø­ Ø³Û’ Ø±Ø§Øª Ú©Ùˆ Ù…ÛØ¯ÛŒØ§Ù†Û ØªÚ© Ú©Ø§Ø±Ø¢Ù…Ø¯|Ú©Ø§ Ø¹Ø§Ù„Ù…ÛŒ',
              centerBoxTitle: 'Ø¯ÛŒÙ†ÛŒ Ø§ÙˆØ± Ø¹ØµØ±ÛŒ Ø¹Ù„ÙˆÙ… Ú©Ø§ Ø­Ø³ÛŒÙ† Ø§Ù…ØªØ²Ø§Ø¬',
              centerBoxContent: 'ÛÙ… Ù†Û Ø¨Ú†ÙˆÚº Ú©ÛŒ ØªØ±Ø¨ÛŒØª Ú©Û’ Ø­ÙˆØ§Ù„Û’ Ø³Û’ Ù…Ú©Ù…Ù„ ØªØ­Ù‚ÛŒÙ‚ Ùˆ Ø¬Ø³ØªØ¬Ùˆ Ú©Û’ Ø¨Ø¹Ø¯ Ø§ÛŒÚ© Ø¨ÛØªØ±ÛŒÙ† Ù†ØµØ§Ø¨ ØªØ¹Ù„ÛŒÙ…Û”Û”Û” Ù…Ù‚Ø±Ø±: 13000 Ø±ÙˆÙ¾Û’ ÙÛŒØ³: 10000 Ø±ÙˆÙ¾Û’',
              rightBoxTitle: 'Ú¯Ú¾Ø± Ø¢ Ú©Û’ Ø¯Ø§Ø®Ù„Û',
              rightBoxTitle: 'Ú¯Ú¾Ø± Ø¢ Ú©Û’ Ø¯Ø§Ø®Ù„Û',
              rightBoxContent: 'Ø§ÙˆÙ„ÛŒÙ° Ø³Û’ Ù„Û’ Ú©Ø± Ø¯ÙˆØ³Ø±ÛŒ Ø¬Ù…Ø§Ø¹Øª ØªÚ©|Ø¨Û’ Ø¬Ù…Û Ø­ÙØ¸ Ú©Û’ Ù„ÛŒÛ’ 60 Ø³Û’ Ø²Ø§Ø¦Ø¯|Ú©ØªØ§Ø¨ Ú©Û’ Ø§ÛŒØ³Û’ Ù†ÙˆÙ¹Ø³ Ú©Û’ Ø¨Ø§Ø¹Ø« ÙˆØ§Ø¶Ø­|ØªÙØ³ÛŒØ± ÙˆØ§Ù„Û’ Ù…Ø¤Ø«Ù‚ Ø§Ø³Ø§ØªØ°Û Ø³Ù†Ø¦ÛŒØ± Ø§Ø³Ø§ØªØ°Û Ø³Û’ Ø§Ø³ØªÙØ§Ø¯Û Ú©Ø±ÛŒÚº Ø¹Ù„Ø§Ù…Û Ø¨Ù†Ù†Û’ Ú©Ø§ Ù…ÙˆÙ‚Ø¹',
              contactNumbers: '0336-9586656, 0311-5342747, 0312-3550107',
              madrasaName: 'Ù…Ø¯Ø±Ø³Û Ø¹Ø±Ø¨ÛŒÛ Ø§Ø³Ù„Ø§Ù…ÛŒÛ Ù…Ø­Ù…Ø¯ Ù¾Ù„',
              madrasaAddress: 'Ø´Ø§Û Ø¬ÛØ§Úº Ø¢Ø¨Ø§Ø¯ Ø³Ø±Ø§Ø¦Û’ Ú©Ø±Ø§Ø¦ÛŒ',
              createdAt: Date.now()
            },
            {
              mainTitle: 'Ø¨Ø±Ø§Ø¦Û’ Ø¯Ø§Ø®Ù„Û Ø¯Ø±Ø³Ú¯Ø§Û',
              islamicDate: '1446Ú¾',
              gregorianDate: '2025Ø¡',
              startDate: '1 Ù…Ø­Ø±Ù… Ø§Ù„Ø­Ø±Ø§Ù… 1446',
              endDate: '15 Ø§Ú¯Ø³Øª 2025',
              section1Title: 'Ø­ÙØ¸ Ø§Ù„Ù‚Ø±Ø¢Ù†',
              section1Content: 'Ù‚Ø±Ø¢Ù† Ú©Ø±ÛŒÙ… Ú©ÛŒ Ø­ÙØ¸|ØªØ¬ÙˆÛŒØ¯ Ú©ÛŒ ØªØ¹Ù„ÛŒÙ…|Ø¹Ø±Ø¨ÛŒ Ú¯Ø±Ø§Ù…Ø±|Ù†Ù…Ø§Ø² Ú©ÛŒ ØªØ¹Ù„ÛŒÙ…',
              section2Title: 'Ø¯ÛŒÙ†ÛŒ ØªØ¹Ù„ÛŒÙ…',
              section2Content: 'Ø­Ø¯ÛŒØ« Ø´Ø±ÛŒÙ|ÙÙ‚Û Ø§Ø³Ù„Ø§Ù…ÛŒ|Ø¹Ù‚Ø§Ø¦Ø¯ Ùˆ Ø§Ø®Ù„Ø§Ù‚ÛŒØ§Øª|Ø³ÛŒØ±Øª Ø§Ù„Ù†Ø¨ÛŒ ØµÙ„ÛŒ Ø§Ù„Ù„Û Ø¹Ù„ÛŒÛ ÙˆØ³Ù„Ù…',
              section3Title: 'Ø¹ØµØ±ÛŒ ØªØ¹Ù„ÛŒÙ…',
              section3Content: 'Ø§Ø±Ø¯Ùˆ Ø²Ø¨Ø§Ù†|Ø§Ù†Ú¯Ø±ÛŒØ²ÛŒ Ø²Ø¨Ø§Ù†|Ø±ÛŒØ§Ø¶ÛŒ Ú©ÛŒ ØªØ¹Ù„ÛŒÙ…|Ø³Ø§Ø¦Ù†Ø³ Ùˆ Ø³ÙˆØ´Ù„ Ø§Ø³Ù¹ÚˆÛŒØ²',
              timing: 'Ø§ÙˆÙ‚Ø§Øª: ØµØ¨Ø­ 7:00 ØªØ§ Ø¯ÙˆÙ¾ÛØ± 1:00',
              locationInfo: 'Ø¯Ø§Ø®Ù„Û’ Ú©ÛŒ Ø¢Ø®Ø±ÛŒ ØªØ§Ø±ÛŒØ® 15 Ø§Ú¯Ø³Øª 2025 ØªÚ© Ø±ÛÛ’ Ú¯ÛŒ Ø¨Ø±Ø§Û Ú©Ø±Ù… Ø¬Ù„Ø¯ Ø±Ø¬Ø³Ù¹Ø±ÛŒØ´Ù† Ú©Ø±ÙˆØ§Ø¦ÛŒÚº',
              leftBoxTitle: 'Ø³ÛÙˆÙ„ÛŒØ§Øª',
              leftBoxContent: 'Ù…ÙØª ØªØ¹Ù„ÛŒÙ…|Ø±ÛØ§Ø¦Ø´ Ú©ÛŒ Ø³ÛÙˆÙ„Øª|Ù…ÙØª Ú©ØªØ¨|ØµØ­Øª Ú©ÛŒ Ø¯ÛŒÚ©Ú¾ Ø¨Ú¾Ø§Ù„',
              centerBoxTitle: 'ØªØ¹Ù„ÛŒÙ… Ùˆ ØªØ±Ø¨ÛŒØª Ú©Ø§ Ø¨ÛØªØ±ÛŒÙ† Ù…Ø±Ú©Ø²',
              centerBoxContent: 'ÛÙ…Ø§Ø±Ø§ Ù…Ù‚ØµØ¯ Ø·Ù„Ø¨Ø§Ø¡ Ú©Ùˆ Ø¯ÛŒÙ†ÛŒ Ø§ÙˆØ± Ø¯Ù†ÛŒØ§ÙˆÛŒ ØªØ¹Ù„ÛŒÙ… Ø¯ÙˆÙ†ÙˆÚº Ù…ÛŒÚº Ù…Ø§ÛØ± Ø¨Ù†Ø§Ù†Ø§ ÛÛ’ ØªØ§Ú©Û ÙˆÛ Ù…Ø¹Ø§Ø´Ø±Û’ Ú©Û’ Ù„ÛŒÛ’ Ù…ÙÛŒØ¯ Ø´ÛØ±ÛŒ Ø¨Ù† Ø³Ú©ÛŒÚº',
              rightBoxTitle: 'Ø´Ø±Ø§Ø¦Ø· Ø¯Ø§Ø®Ù„Û',
              rightBoxContent: 'Ø¹Ù…Ø± Ú©Ù… Ø§Ø² Ú©Ù… 8 Ø³Ø§Ù„|ØªØ¹Ù„ÛŒÙ…ÛŒ Ø³Ø±Ù¹ÛŒÙÚ©ÛŒÙ¹|ÙˆØ§Ù„Ø¯ÛŒÙ† Ú©ÛŒ Ø§Ø¬Ø§Ø²Øª|Ù…ÛŒÚˆÛŒÚ©Ù„ Ø³Ø±Ù¹ÛŒÙÚ©ÛŒÙ¹',
              contactNumbers: '0300-1234567, 0321-9876543, 0333-5555555',
              madrasaName: 'Ø¬Ø§Ù…Ø¹Û Ù†ØµØ±Øª Ø§Ù„Ø¹Ù„ÙˆÙ…',
              madrasaAddress: 'Ù…Ø­Ù„Û Ø´ÛŒØ®Ø§ÚºØŒ Ù¾Ø´Ø§ÙˆØ±ØŒ Ø®ÛŒØ¨Ø± Ù¾Ø®ØªÙˆÙ†Ø®ÙˆØ§',
              createdAt: Date.now() - 86400000
            },
            {
              mainTitle: 'Ø§Ø¹Ù„Ø§Ù† Ø¨Ø±Ø§Ø¦Û’ ØªØ¹Ù„ÛŒÙ…',
              islamicDate: '1447Ú¾',
              gregorianDate: '2026Ø¡',
              startDate: '5 Ø±Ù…Ø¶Ø§Ù† Ø§Ù„Ù…Ø¨Ø§Ø±Ú© 1447',
              endDate: '10 Ù…Ø§Ø±Ú† 2026',
              section1Title: 'Ø¯ÛŒÙ†ÛŒØ§Øª',
              section1Content: 'Ù‚Ø±Ø¢Ù† Ù…Ø¬ÛŒØ¯|Ø§Ø­Ø§Ø¯ÛŒØ« Ù†Ø¨ÙˆÛŒÛ|ÙÙ‚Û Ùˆ Ø§ØµÙˆÙ„|Ø¹Ø±Ø¨ÛŒ Ø§Ø¯Ø¨',
              section2Title: 'Ø¹Ù„ÙˆÙ… Ø§Ø³Ù„Ø§Ù…ÛŒÛ',
              section2Content: 'ØªÙØ³ÛŒØ± Ù‚Ø±Ø¢Ù†|Ø¹Ù„Ù… Ø­Ø¯ÛŒØ«|Ø§ØµÙˆÙ„ ÙÙ‚Û|ØªØ§Ø±ÛŒØ® Ø§Ø³Ù„Ø§Ù…',
              section3Title: 'Ø¬Ø¯ÛŒØ¯ Ø¹Ù„ÙˆÙ…',
              section3Content: 'Ú©Ù…Ù¾ÛŒÙˆÙ¹Ø± Ø³Ø§Ø¦Ù†Ø³|Ø§Ù†Ú¯Ø±ÛŒØ²ÛŒ Ø§Ø¯Ø¨|Ø±ÛŒØ§Ø¶ÛŒ Ùˆ Ø³Ø§Ø¦Ù†Ø³|Ø³Ù…Ø§Ø¬ÛŒ Ø¹Ù„ÙˆÙ…',
              timing: 'Ø§ÙˆÙ‚Ø§Øª: ØµØ¨Ø­ 6:30 ØªØ§ Ø¸ÛØ± 12:30',
              locationInfo: 'Ø·Ù„Ø¨Ø§Ø¡ Ú©Ùˆ Ù…Ø·Ù„Ø¹ Ú©ÛŒØ§ Ø¬Ø§ØªØ§ ÛÛ’ Ú©Û Ø¯Ø§Ø®Ù„Û’ Ú©Û’ Ù„ÛŒÛ’ 10 Ù…Ø§Ø±Ú† ØªÚ© Ø¶Ø±ÙˆØ± Ø±Ø§Ø¨Ø·Û Ú©Ø±ÛŒÚº',
              leftBoxTitle: 'Ø§Ù…ØªÛŒØ§Ø²Ø§Øª',
              leftBoxContent: 'ØªØ¬Ø±Ø¨Û Ú©Ø§Ø± Ø§Ø³Ø§ØªØ°Û|Ø¬Ø¯ÛŒØ¯ Ù„Ø§Ø¦Ø¨Ø±ÛŒØ±ÛŒ|Ø³Ù¾ÙˆØ±Ù¹Ø³ Ú©ÛŒ Ø³ÛÙˆÙ„ÛŒØ§Øª|ÚˆÛŒØ¬ÛŒÙ¹Ù„ Ú©Ù„Ø§Ø³ Ø±ÙˆÙ…Ø²',
              centerBoxTitle: 'Ø§Ø³Ù„Ø§Ù…ÛŒ ØªØ¹Ù„ÛŒÙ… Ú©Ø§ Ù…Ø±Ú©Ø²',
              centerBoxContent: 'Ø·Ù„Ø¨Ø§Ø¡ Ú©Ùˆ Ø¯ÛŒÙ†ÛŒ Ø§ÙˆØ± Ø¹ØµØ±ÛŒ ØªØ¹Ù„ÛŒÙ… Ú©Û’ Ø³Ø§ØªÚ¾ Ø³Ø§ØªÚ¾ Ø§Ø®Ù„Ø§Ù‚ÛŒ ØªØ±Ø¨ÛŒØª Ø¨Ú¾ÛŒ Ø¯ÛŒ Ø¬Ø§ØªÛŒ ÛÛ’ ØªØ§Ú©Û ÙˆÛ Ø¨ÛØªØ± Ù…Ø³Ù„Ù…Ø§Ù† Ø§ÙˆØ± Ø´ÛØ±ÛŒ Ø¨Ù† Ø³Ú©ÛŒÚº',
              rightBoxTitle: 'Ø¶Ø±ÙˆØ±ÛŒØ§Øª',
              rightBoxContent: 'Ù…ÛŒÙ¹Ø±Ú© Ø³Ø±Ù¹ÛŒÙÚ©ÛŒÙ¹|Ø¯Ùˆ ØªØµØ§ÙˆÛŒØ±|ÙÛŒØ³ 5000 Ø±ÙˆÙ¾Û’|Ø³Ø§Ø¨Ù‚Û Ø³Ú©ÙˆÙ„ Ú©Ø§ Ø±ÛŒÚ©Ø§Ø±Úˆ',
              contactNumbers: '0345-7778888, 0301-2223333, 0322-4445555',
              madrasaName: 'Ø¯Ø§Ø±Ø§Ù„Ø¹Ù„ÙˆÙ… ÙÛŒØ¶Ø§Ù† Ù…Ø¯ÛŒÙ†Û',
              madrasaAddress: 'Ú¯Ù†Ø¬ Ú¯ÛŒÙ¹ØŒ Ù¾Ø´Ø§ÙˆØ±ØŒ Ø®ÛŒØ¨Ø± Ù¾Ø®ØªÙˆÙ†Ø®ÙˆØ§',
              createdAt: Date.now() - 172800000
            },
            {
              mainTitle: 'Ù†ÛŒØ§ ØªØ¹Ù„ÛŒÙ…ÛŒ Ø³ÛŒØ´Ù†',
              islamicDate: '1445Ú¾',
              gregorianDate: '2024Ø¡',
              startDate: '25 Ø°ÛŒ Ø§Ù„Ù‚Ø¹Ø¯Û 1445',
              endDate: '1 Ø¬ÙˆÙ† 2024',
              section1Title: 'Ù‚Ø±Ø¢Ù†ÛŒ Ø¹Ù„ÙˆÙ…',
              section1Content: 'Ù†Ø§Ø¸Ø±Û Ù‚Ø±Ø¢Ù†|Ø­ÙØ¸ Ù‚Ø±Ø¢Ù†|ØªÙØ³ÛŒØ±|Ù‚Ø±Ø§Øª',
              section2Title: 'Ø­Ø¯ÛŒØ« Ùˆ ÙÙ‚Û',
              section2Content: 'Ø¨Ø®Ø§Ø±ÛŒ Ø´Ø±ÛŒÙ|Ù…Ø³Ù„Ù… Ø´Ø±ÛŒÙ|ØªØ±Ù…Ø°ÛŒ Ø´Ø±ÛŒÙ|Ø§Ø¨Ùˆ Ø¯Ø§Ø¤Ø¯ Ø´Ø±ÛŒÙ',
              section3Title: 'Ù…Ø¹Ø§ØµØ± Ø¹Ù„ÙˆÙ…',
              section3Content: 'Ø§Ø±Ø¯Ùˆ Ø§Ø¯Ø¨|Ø§Ù†Ú¯Ø±ÛŒØ²ÛŒ|Ú©Ù…Ù¾ÛŒÙˆÙ¹Ø±|Ø¹Ø§Ù… Ø³Ø§Ø¦Ù†Ø³',
              timing: 'Ø§ÙˆÙ‚Ø§Øª: ØµØ¨Ø­ 8:30 ØªØ§ Ø¯ÙˆÙ¾ÛØ± 2:00',
              locationInfo: 'Ø¯Ø§Ø®Ù„Û’ Ú©Û’ Ø®ÙˆØ§ÛØ´Ù…Ù†Ø¯ Ø·Ù„Ø¨Ø§Ø¡ 1 Ø¬ÙˆÙ† ØªÚ© Ø±Ø¬Ø³Ù¹Ø±ÛŒØ´Ù† Ú©Ø±ÙˆØ§ Ø³Ú©ØªÛ’ ÛÛŒÚº',
              leftBoxTitle: 'Ø®ØµÙˆØµÛŒØ§Øª',
              leftBoxContent: 'Ù…Ø§ÛØ± Ø§Ø³Ø§ØªØ°Û|Ù…ÙØª Ú©ØªØ¨|Ø±ÛØ§Ø¦Ø´|Ú©Ú¾Ø§Ù†Û’ Ú©ÛŒ Ø³ÛÙˆÙ„Øª',
              centerBoxTitle: 'Ø¹Ù„Ù… Ùˆ Ø¹Ù…Ù„ Ú©Ø§ Ø³Ù†Ú¯Ù…',
              centerBoxContent: 'ÛÙ…Ø§Ø±Ø§ Ø§Ø¯Ø§Ø±Û Ø·Ù„Ø¨Ø§Ø¡ Ú©Ùˆ Ø¹Ù„Ù… Ú©Û’ Ø³Ø§ØªÚ¾ Ø³Ø§ØªÚ¾ Ø¹Ù…Ù„ Ú©ÛŒ ØªØ±Ø¨ÛŒØª Ø¨Ú¾ÛŒ ÙØ±Ø§ÛÙ… Ú©Ø±ØªØ§ ÛÛ’ ØªØ§Ú©Û ÙˆÛ Ø¹Ù…Ù„ÛŒ Ø²Ù†Ø¯Ú¯ÛŒ Ù…ÛŒÚº Ú©Ø§Ù…ÛŒØ§Ø¨ ÛÙˆÚº',
              rightBoxTitle: 'Ø¯Ø§Ø®Ù„Û Ø´Ø±Ø§Ø¦Ø·',
              rightBoxContent: 'Ú©Ù… Ø§Ø² Ú©Ù… Ø¢Ù¹Ú¾ÙˆÛŒÚº Ù¾Ø§Ø³|ØµØ­Øª Ú©Ø§ Ø³Ø±Ù¹ÛŒÙÚ©ÛŒÙ¹|ÙˆØ§Ù„Ø¯ÛŒÙ† Ú©ÛŒ ØªØ­Ø±ÛŒØ±ÛŒ Ø§Ø¬Ø§Ø²Øª|Ù¾ÙˆÙ„ÛŒØ³ ØªØµØ¯ÛŒÙ‚',
              contactNumbers: '0333-1112222, 0344-3334444, 0355-6667777',
              madrasaName: 'Ø¬Ø§Ù…Ø¹Û Ø§Ø¨Ùˆ Ø¨Ú©Ø± ØµØ¯ÛŒÙ‚',
              madrasaAddress: 'ÛŒÙˆÙ†ÛŒÙˆØ±Ø³Ù¹ÛŒ Ø±ÙˆÚˆØŒ Ù¾Ø´Ø§ÙˆØ±ØŒ Ø®ÛŒØ¨Ø± Ù¾Ø®ØªÙˆÙ†Ø®ÙˆØ§',
              createdAt: Date.now() - 259200000
            }
          ];
          for (const data of seedData) {
            await addPoster(data);
          }
          loadPosters();
        }
      };
    };

    const addPoster = (data) => {
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['posters'], 'readwrite');
        const objectStore = transaction.objectStore('posters');
        const request = objectStore.add(data);
        request.onsuccess = () => resolve(request.result);
        request.onerror = () => reject(request.error);
      });
    };

    const updatePoster = (id, data) => {
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['posters'], 'readwrite');
        const objectStore = transaction.objectStore('posters');
        const request = objectStore.put({ ...data, id });
        request.onsuccess = () => resolve(request.result);
        request.onerror = () => reject(request.error);
      });
    };

    const deletePoster = (id) => {
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['posters'], 'readwrite');
        const objectStore = transaction.objectStore('posters');
        const request = objectStore.delete(id);
        request.onsuccess = () => resolve();
        request.onerror = () => reject(request.error);
      });
    };

    const getAllPosters = () => {
      return new Promise((resolve, reject) => {
        const transaction = db.transaction(['posters'], 'readonly');
        const objectStore = transaction.objectStore('posters');
        const request = objectStore.getAll();
        request.onsuccess = () => resolve(request.result);
        request.onerror = () => reject(request.error);
      });
    };

    const createPosterHTML = (data) => {
      const section1Items = data.section1Content.split('|');
      const section2Items = data.section2Content.split('|');
      const section3Items = data.section3Content.split('|');
      const leftBoxItems = data.leftBoxContent.split('|');
      const rightBoxItems = data.rightBoxContent.split('|');
      const contacts = data.contactNumbers.split(',');

      return `
<div class="poster-template" id="poster-${data.id}">
<div class="decorative-minaret left">
<div class="minaret-crescent"></div>
<div class="minaret-spire"></div>
<div class="minaret-dome"></div>
</div>
<div class="decorative-minaret right">
<div class="minaret-crescent"></div>
<div class="minaret-spire"></div>
<div class="minaret-dome"></div>
</div>

<div class="decorative-lantern left">
<div class="lantern-top"></div>
<div class="lantern-body"></div>
<div class="lantern-bottom"></div>
</div>
<div class="decorative-lantern right">
<div class="lantern-top"></div>
<div class="lantern-body"></div>
<div class="lantern-bottom"></div>
</div>

<div class="decorative-crescent left">
<div class="crescent-shape">
<div class="crescent-inner"></div>
</div>
<div class="diamond-shape"></div>
</div>
<div class="decorative-crescent right">
<div class="crescent-shape">
<div class="crescent-inner"></div>
</div>
<div class="diamond-shape"></div>
</div>

<div class="poster-main-header">
<h1 class="main-title">${data.mainTitle}</h1>
<h2 class="subtitle">${data.islamicDate}/${data.gregorianDate}</h2>
</div>

<div class="dates-oval">
<div class="date-item">
<span class="date-number">10</span>
${data.startDate}
</div>
<div class="date-item">
<span class="date-number">20</span>
${data.endDate}
</div>
</div>

<div class="three-sections">
<div class="section-box">
<div class="section-header orange">${data.section1Title}</div>
<div class="section-content blue">
${section1Items.map(item => `<div class="content-item">${item.trim()}</div>`).join('')}
</div>
</div>

<div class="section-box">
<div class="section-header green">${data.section2Title}</div>
<div class="section-content pink">
${section2Items.map(item => `<div class="content-item">${item.trim()}</div>`).join('')}
</div>
</div>

<div class="section-box">
<div class="section-header orange">${data.section3Title}</div>
<div class="section-content blue">
${section3Items.map(item => `<div class="content-item">${item.trim()}</div>`).join('')}
</div>
</div>
</div>

<div class="timing-bar">
${data.timing}
</div>

<div class="location-bar">
<div class="ornament"></div>
<div style="flex: 1;">${data.locationInfo}</div>
<div class="ornament"></div>
</div>

<div class="bottom-section">
<div class="side-box">
<div class="side-box-title">${data.leftBoxTitle}</div>
<div class="side-box-content">
${leftBoxItems.map(item => `<div>${item.trim()}</div>`).join('')}
</div>
</div>

<div class="center-box">
<div class="center-box-title">${data.centerBoxTitle}</div>
<div class="center-box-content">${data.centerBoxContent}</div>
</div>

<div class="side-box">
<div class="side-box-title">${data.rightBoxTitle}</div>
<div class="side-box-content">
${rightBoxItems.map(item => `<div>${item.trim()}</div>`).join('')}
</div>
</div>
</div>

<div class="footer-banner">
<div class="footer-item">
<div class="diamond-icon"></div>
${contacts.map(c => `<div class="phone-number">${c.trim()}</div>`).join('<br>')}
</div>
<div class="footer-text">${data.madrasaName}<br>${data.madrasaAddress}</div>
<div class="footer-item">
<div class="diamond-icon"></div>
</div>
</div>
</div>
`;
    };

    const loadPosters = async () => {
      const posters = await getAllPosters();
      const grid = document.getElementById('posterGrid');
      grid.innerHTML = '';
      for (const poster of posters) {
        const posterHTML = createPosterHTML(poster);
        const card = document.createElement('div');
        card.className = 'poster-card';
        card.innerHTML = `
<div onclick="previewPoster(${poster.id})" style="cursor: pointer;">
${posterHTML}
</div>
<div class="poster-actions">
<button class="btn btn-info" onclick="editPoster(${poster.id})">âœï¸ ØªØ±Ù…ÛŒÙ…</button>
<button class="btn btn-success" onclick="duplicatePoster(${poster.id})">ğŸ“‹ Ù†Ù‚Ù„</button>
<button class="btn btn-danger" onclick="confirmDelete(${poster.id})">ğŸ—‘ï¸ Ø­Ø°Ù</button>
</div>
`;
        grid.appendChild(card);
      }
    };

    const openCreateModal = () => {
      document.getElementById('posterForm').reset();
      document.getElementById('posterId').value = '';
      document.getElementById('editorModal').classList.add('active');
    };

    const closeModal = () => {
      document.getElementById('editorModal').classList.remove('active');
    };

    const closePreviewModal = () => {
      document.getElementById('previewModal').classList.remove('active');
      currentPosterData = null;
    };

    const editPoster = async (id) => {
      const transaction = db.transaction(['posters'], 'readonly');
      const objectStore = transaction.objectStore('posters');
      const request = objectStore.get(id);
      request.onsuccess = () => {
        const poster = request.result;
        document.getElementById('posterId').value = poster.id;
        document.getElementById('mainTitle').value = poster.mainTitle;
        document.getElementById('islamicDate').value = poster.islamicDate;
        document.getElementById('gregorianDate').value = poster.gregorianDate;
        document.getElementById('startDate').value = poster.startDate;
        document.getElementById('endDate').value = poster.endDate;
        document.getElementById('section1Title').value = poster.section1Title;
        document.getElementById('section1Content').value = poster.section1Content;
        document.getElementById('section2Title').value = poster.section2Title;
        document.getElementById('section2Content').value = poster.section2Content;
        document.getElementById('section3Title').value = poster.section3Title;
        document.getElementById('section3Content').value = poster.section3Content;
        document.getElementById('timing').value = poster.timing;
        document.getElementById('locationInfo').value = poster.locationInfo;
        document.getElementById('leftBoxTitle').value = poster.leftBoxTitle;
        document.getElementById('leftBoxContent').value = poster.leftBoxContent;
        document.getElementById('centerBoxTitle').value = poster.centerBoxTitle;
        document.getElementById('centerBoxContent').value = poster.centerBoxContent;
        document.getElementById('rightBoxTitle').value = poster.rightBoxTitle;
        document.getElementById('rightBoxContent').value = poster.rightBoxContent;
        document.getElementById('contactNumbers').value = poster.contactNumbers;
        document.getElementById('madrasaName').value = poster.madrasaName;
        document.getElementById('madrasaAddress').value = poster.madrasaAddress;
        document.getElementById('editorModal').classList.add('active');
      };
    };

    const savePoster = async (event) => {
      event.preventDefault();
      const id = document.getElementById('posterId').value;
      const posterData = {
        mainTitle: document.getElementById('mainTitle').value,
        islamicDate: document.getElementById('islamicDate').value,
        gregorianDate: document.getElementById('gregorianDate').value,
        startDate: document.getElementById('startDate').value,
        endDate: document.getElementById('endDate').value,
        section1Title: document.getElementById('section1Title').value,
        section1Content: document.getElementById('section1Content').value,
        section2Title: document.getElementById('section2Title').value,
        section2Content: document.getElementById('section2Content').value,
        section3Title: document.getElementById('section3Title').value,
        section3Content: document.getElementById('section3Content').value,
        timing: document.getElementById('timing').value,
        locationInfo: document.getElementById('locationInfo').value,
        leftBoxTitle: document.getElementById('leftBoxTitle').value,
        leftBoxContent: document.getElementById('leftBoxContent').value,
        centerBoxTitle: document.getElementById('centerBoxTitle').value,
        centerBoxContent: document.getElementById('centerBoxContent').value,
        rightBoxTitle: document.getElementById('rightBoxTitle').value,
        rightBoxContent: document.getElementById('rightBoxContent').value,
        contactNumbers: document.getElementById('contactNumbers').value,
        madrasaName: document.getElementById('madrasaName').value,
        madrasaAddress: document.getElementById('madrasaAddress').value,
        createdAt: id ? undefined : Date.now()
      };
      if (id) {
        await updatePoster(parseInt(id), posterData);
      } else {
        await addPoster(posterData);
      }
      closeModal();
      await loadPosters();
    };

    const confirmDelete = (id) => {
      if (confirm('Ú©ÛŒØ§ Ø¢Ù¾ ÙˆØ§Ù‚Ø¹ÛŒ ÛŒÛ Ù¾ÙˆØ³Ù¹Ø± Ø­Ø°Ù Ú©Ø±Ù†Ø§ Ú†Ø§ÛØªÛ’ ÛÛŒÚºØŸ')) {
        deletePoster(id).then(() => loadPosters());
      }
    };

    const duplicatePoster = async (id) => {
      const transaction = db.transaction(['posters'], 'readonly');
      const objectStore = transaction.objectStore('posters');
      const request = objectStore.get(id);
      request.onsuccess = async () => {
        const poster = request.result;
        delete poster.id;
        poster.mainTitle += ' (Ù†Ù‚Ù„)';
        poster.createdAt = Date.now();
        await addPoster(poster);
        await loadPosters();
      };
    };

    const deleteAllPosters = () => {
      if (confirm('Ú©ÛŒØ§ Ø¢Ù¾ ØªÙ…Ø§Ù… Ù¾ÙˆØ³Ù¹Ø± Ø­Ø°Ù Ú©Ø±Ù†Ø§ Ú†Ø§ÛØªÛ’ ÛÛŒÚºØŸ ÛŒÛ Ø¹Ù…Ù„ ÙˆØ§Ù¾Ø³ Ù†ÛÛŒÚº ÛÙˆ Ø³Ú©ØªØ§Û”')) {
        const transaction = db.transaction(['posters'], 'readwrite');
        const objectStore = transaction.objectStore('posters');
        objectStore.clear();
        transaction.oncomplete = () => loadPosters();
      }
    };

    const previewPoster = async (id) => {
      showLoading();
      const transaction = db.transaction(['posters'], 'readonly');
      const objectStore = transaction.objectStore('posters');
      const request = objectStore.get(id);
      request.onsuccess = async () => {
        currentPosterData = request.result;
        currentPosterId = id;
        const posterHTML = createPosterHTML(currentPosterData);
        document.getElementById('previewContainer').innerHTML = posterHTML;
        document.getElementById('previewModal').classList.add('active');
        hideLoading();
      };
    };

    const exportToPNG = async () => {
      if (!currentPosterData) return;
      showLoading();
      const posterElement = document.querySelector('#previewContainer .poster-template');
      const canvas = await html2canvas(posterElement, {
        scale: 4,
        useCORS: true,
        backgroundColor: '#bae6fd',
        logging: false,
        width: 700,
        height: 990
      });
      canvas.toBlob((blob) => {
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `${currentPosterData.mainTitle.replace(/\s+/g, '_')}_poster_${Date.now()}.png`;
        a.click();
        URL.revokeObjectURL(url);
        hideLoading();
      }, 'image/png', 1.0);
    };

    const exportToPDF = async () => {
      if (!currentPosterData) return;
      showLoading();
      const posterElement = document.querySelector('#previewContainer .poster-template');
      const canvas = await html2canvas(posterElement, {
        scale: 4,
        useCORS: true,
        backgroundColor: '#bae6fd',
        logging: false,
        width: 700,
        height: 990
      });
      const imgData = canvas.toDataURL('image/png', 1.0);
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF({
        orientation: 'portrait',
        unit: 'mm',
        format: 'a4',
        compress: true
      });
      const imgWidth = 210;
      const imgHeight = 297;
      pdf.addImage(imgData, 'PNG', 0, 0, imgWidth, imgHeight, '', 'FAST');
      pdf.save(`${currentPosterData.mainTitle.replace(/\s+/g, '_')}_poster_${Date.now()}.pdf`);
      hideLoading();
    };

    const exportAllData = async () => {
      const posters = await getAllPosters();
      const dataStr = JSON.stringify(posters, null, 2);
      const blob = new Blob([dataStr], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `madrasa_posters_backup_${Date.now()}.json`;
      a.click();
      URL.revokeObjectURL(url);
    };

    const importData = (event) => {
      const file = event.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = async (e) => {
        try {
          const data = JSON.parse(e.target.result);
          if (!Array.isArray(data)) {
            alert('ØºÙ„Ø· ÙØ§Ø¦Ù„ ÙØ§Ø±Ù…ÛŒÙ¹');
            return;
          }
          for (const poster of data) {
            delete poster.id;
            await addPoster(poster);
          }
          await loadPosters();
          alert('ÚˆÛŒÙ¹Ø§ Ú©Ø§Ù…ÛŒØ§Ø¨ÛŒ Ø³Û’ Ø¯Ø±Ø¢Ù…Ø¯ ÛÙˆ Ú¯ÛŒØ§');
        } catch (error) {
          alert('ÙØ§Ø¦Ù„ Ù¾Ú‘Ú¾Ù†Û’ Ù…ÛŒÚº Ø®Ø±Ø§Ø¨ÛŒ: ' + error.message);
        }
      };
      reader.readAsText(file);
      event.target.value = '';
    };

    const showLoading = () => {
      document.getElementById('loadingOverlay').classList.add('active');
    };

    const hideLoading = () => {
      document.getElementById('loadingOverlay').classList.remove('active');
    };

    window.addEventListener('DOMContentLoaded', async () => {
      await initDB();
      await seedInitialData();
      await loadPosters();
    });
  </script>
<script type="module">
  import { Workbox } from 'https://storage.googleapis.com/workbox-cdn/releases/7.0.0/workbox-window.prod.mjs';

  const swUrl = './sw.js';
  const wb = new Workbox(swUrl);

  wb.addEventListener('waiting', () => {
    console.log('A new service worker is waiting to activate.');
    wb.messageSW({ type: 'SKIP_WAITING' });
  });

  wb.addEventListener('controlling', () => {
    console.log('The new service worker is now in control. Reloading page for updates...');
    window.location.reload();
  });

  wb.register();
</script></body>
</html>